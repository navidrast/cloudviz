<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudViz - Multi-Cloud Infrastructure Visualization</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Chart.js for cost analytics -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.min.js"></script>
    <!-- Mermaid.js for live diagram rendering -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.8.0/dist/mermaid.min.js"></script>
    
    <style>
        .navbar-brand {
            font-weight: 600;
        }
        .section-card {
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .provider-card {
            border: 2px solid #e9ecef;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .provider-card:hover {
            border-color: #0d6efd;
            box-shadow: 0 4px 12px rgba(13, 110, 253, 0.15);
        }
        .provider-card.active {
            border-color: #0d6efd;
            background-color: #f8f9ff;
        }
        .scan-button {
            min-width: 120px;
        }
        .progress-container {
            display: none;
        }
        .diagram-container {
            min-height: 400px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background-color: #f8f9fa;
            overflow: auto;
        }
        .cost-chart-container {
            position: relative;
            height: 300px;
        }
        .status-badge {
            font-size: 0.75rem;
        }
        .credential-form {
            display: none;
        }
        .credential-form.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="bi bi-cloud-arrow-up me-2"></i>CloudViz
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text">
                    <i class="bi bi-circle-fill text-success me-1"></i>
                    <span id="connection-status">Connected</span>
                </span>
            </div>
        </div>
    </nav>

    <div class="container-fluid py-4">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3">
                <!-- Cloud Provider Setup -->
                <div class="card section-card">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-gear me-2"></i>Cloud Providers
                        </h5>
                    </div>
                    <div class="card-body">
                        <!-- Azure Provider -->
                        <div class="provider-card p-3 mb-3" data-provider="azure">
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="mb-1">
                                        <i class="bi bi-microsoft text-primary me-2"></i>Azure
                                    </h6>
                                    <small class="text-muted">Microsoft Azure</small>
                                </div>
                                <span class="badge status-badge bg-secondary" id="azure-status">Not Configured</span>
                            </div>
                        </div>

                        <!-- AWS Provider -->
                        <div class="provider-card p-3 mb-3" data-provider="aws">
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="mb-1">
                                        <i class="bi bi-amazon text-warning me-2"></i>AWS
                                    </h6>
                                    <small class="text-muted">Amazon Web Services</small>
                                </div>
                                <span class="badge status-badge bg-secondary" id="aws-status">Not Configured</span>
                            </div>
                        </div>

                        <!-- GCP Provider -->
                        <div class="provider-card p-3 mb-3" data-provider="gcp">
                            <div class="d-flex align-items-center justify-content-between">
                                <div>
                                    <h6 class="mb-1">
                                        <i class="bi bi-google text-danger me-2"></i>GCP
                                    </h6>
                                    <small class="text-muted">Google Cloud Platform</small>
                                </div>
                                <span class="badge status-badge bg-secondary" id="gcp-status">Not Configured</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scan Controls -->
                <div class="card section-card">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-search me-2"></i>Resource Discovery
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary scan-button" id="scan-all">
                                <i class="bi bi-cloud-check me-2"></i>Scan All Clouds
                            </button>
                            <button class="btn btn-outline-primary scan-button" id="scan-azure">
                                <i class="bi bi-microsoft me-2"></i>Scan Azure
                            </button>
                            <button class="btn btn-outline-primary scan-button" id="scan-aws">
                                <i class="bi bi-amazon me-2"></i>Scan AWS
                            </button>
                            <button class="btn btn-outline-primary scan-button" id="scan-gcp">
                                <i class="bi bi-google me-2"></i>Scan GCP
                            </button>
                        </div>
                        
                        <!-- Progress Indicators -->
                        <div class="progress-container mt-3">
                            <div class="progress mb-2">
                                <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                            </div>
                            <small class="text-muted">
                                <span id="progress-text">Ready to scan...</span>
                            </small>
                        </div>
                    </div>
                </div>

                <!-- Export Controls -->
                <div class="card section-card">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">
                            <i class="bi bi-download me-2"></i>Export & Share
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label">Format:</label>
                            <select class="form-select" id="export-format">
                                <option value="svg">SVG (Vector)</option>
                                <option value="png">PNG (Image)</option>
                                <option value="pdf">PDF (Document)</option>
                                <option value="mermaid">Mermaid (Code)</option>
                            </select>
                        </div>
                        <div class="d-grid gap-2">
                            <button class="btn btn-success" id="download-diagram">
                                <i class="bi bi-download me-2"></i>Download
                            </button>
                            <button class="btn btn-outline-info" id="share-link">
                                <i class="bi bi-share me-2"></i>Share Link
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9">
                <!-- Resource Summary -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card text-center">
                            <div class="card-body">
                                <h4 class="text-primary" id="total-resources">0</h4>
                                <small class="text-muted">Total Resources</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center">
                            <div class="card-body">
                                <h4 class="text-success" id="total-cost">$0</h4>
                                <small class="text-muted">Monthly Cost</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center">
                            <div class="card-body">
                                <h4 class="text-warning" id="total-regions">0</h4>
                                <small class="text-muted">Regions</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card text-center">
                            <div class="card-body">
                                <h4 class="text-info" id="last-scan">Never</h4>
                                <small class="text-muted">Last Scan</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs for Main Content -->
                <ul class="nav nav-tabs" id="main-tabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="diagram-tab" data-bs-toggle="tab" data-bs-target="#diagram-pane" type="button" role="tab">
                            <i class="bi bi-diagram-3 me-2"></i>Infrastructure Diagram
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="costs-tab" data-bs-toggle="tab" data-bs-target="#costs-pane" type="button" role="tab">
                            <i class="bi bi-graph-up me-2"></i>Cost Analytics
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings-pane" type="button" role="tab">
                            <i class="bi bi-gear me-2"></i>Settings
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="main-tab-content">
                    <!-- Diagram Tab -->
                    <div class="tab-pane fade show active" id="diagram-pane" role="tabpanel">
                        <div class="card section-card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Infrastructure Visualization</h5>
                                <div>
                                    <div class="btn-group" role="group">
                                        <button class="btn btn-sm btn-outline-secondary" id="zoom-in">
                                            <i class="bi bi-zoom-in"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary" id="zoom-out">
                                            <i class="bi bi-zoom-out"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-secondary" id="reset-zoom">
                                            <i class="bi bi-arrows-fullscreen"></i>
                                        </button>
                                    </div>
                                    <select class="form-select form-select-sm d-inline-block w-auto ms-2" id="theme-selector">
                                        <option value="default">Default Theme</option>
                                        <option value="dark">Dark Theme</option>
                                        <option value="forest">Forest Theme</option>
                                        <option value="neutral">Neutral Theme</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body p-0">
                                <div class="diagram-container p-3" id="diagram-display">
                                    <div class="text-center text-muted py-5">
                                        <i class="bi bi-cloud-slash display-1"></i>
                                        <h5 class="mt-3">No Infrastructure Data</h5>
                                        <p>Configure your cloud providers and run a scan to visualize your infrastructure.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Costs Tab -->
                    <div class="tab-pane fade" id="costs-pane" role="tabpanel">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card section-card">
                                    <div class="card-header">
                                        <h5 class="mb-0">Cost Breakdown by Provider</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="cost-chart-container">
                                            <canvas id="provider-cost-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card section-card">
                                    <div class="card-header">
                                        <h5 class="mb-0">Monthly Spending Trend</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="cost-chart-container">
                                            <canvas id="spending-trend-chart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card section-card">
                            <div class="card-header">
                                <h5 class="mb-0">Cost Optimization Recommendations</h5>
                            </div>
                            <div class="card-body">
                                <div id="recommendations-list">
                                    <div class="text-center text-muted py-3">
                                        <i class="bi bi-lightbulb display-4"></i>
                                        <p class="mt-2">Run a scan to get cost optimization recommendations.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Tab -->
                    <div class="tab-pane fade" id="settings-pane" role="tabpanel">
                        <!-- Azure Credentials Form -->
                        <div class="card section-card credential-form" id="azure-form">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0">
                                    <i class="bi bi-microsoft me-2"></i>Azure Configuration
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="azure-credentials">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Tenant ID *</label>
                                                <input type="text" class="form-control" name="tenant_id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Client ID *</label>
                                                <input type="text" class="form-control" name="client_id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Client Secret *</label>
                                        <input type="password" class="form-control" name="client_secret" placeholder="Enter client secret" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Subscription IDs (comma-separated)</label>
                                        <input type="text" class="form-control" name="subscription_ids" placeholder="sub1,sub2,sub3">
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="bi bi-check-circle me-2"></i>Save Configuration
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="testConnection('azure')">
                                            <i class="bi bi-plug me-2"></i>Test Connection
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- AWS Credentials Form -->
                        <div class="card section-card credential-form" id="aws-form">
                            <div class="card-header bg-warning text-dark">
                                <h5 class="mb-0">
                                    <i class="bi bi-amazon me-2"></i>AWS Configuration
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="aws-credentials">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Access Key ID *</label>
                                                <input type="text" class="form-control" name="access_key_id" placeholder="AKIAIOSFODNN7EXAMPLE" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label class="form-label">Secret Access Key *</label>
                                                <input type="password" class="form-control" name="secret_access_key" placeholder="wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Regions (comma-separated)</label>
                                        <input type="text" class="form-control" name="regions" placeholder="us-east-1,us-west-2,eu-west-1" value="us-east-1">
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Session Token (optional)</label>
                                        <input type="password" class="form-control" name="session_token" placeholder="For temporary credentials">
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="submit" class="btn btn-warning text-dark">
                                            <i class="bi bi-check-circle me-2"></i>Save Configuration
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="testConnection('aws')">
                                            <i class="bi bi-plug me-2"></i>Test Connection
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- GCP Credentials Form -->
                        <div class="card section-card credential-form" id="gcp-form">
                            <div class="card-header bg-danger text-white">
                                <h5 class="mb-0">
                                    <i class="bi bi-google me-2"></i>GCP Configuration
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="gcp-credentials">
                                    <div class="mb-3">
                                        <label class="form-label">Project ID *</label>
                                        <input type="text" class="form-control" name="project_id" placeholder="my-project-id" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Service Account JSON *</label>
                                        <textarea class="form-control" name="service_account_json" rows="10" placeholder="Paste your service account JSON here..." required></textarea>
                                        <div class="form-text">
                                            Download the service account key from the Google Cloud Console and paste the JSON content here.
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button type="submit" class="btn btn-danger">
                                            <i class="bi bi-check-circle me-2"></i>Save Configuration
                                        </button>
                                        <button type="button" class="btn btn-outline-secondary" onclick="testConnection('gcp')">
                                            <i class="bi bi-plug me-2"></i>Test Connection
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="/static/js/app.js"></script>
</body>
</html>